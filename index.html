<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For My Bibi Thangoooo üê±üíñ</title>
    <style>
        :root {
            --bg-dark: #0f172a;
            --pastel-blue: #a2d2ff;
            --soft-pink: #ffafcc;
            --hot-pink: #ff85a1;
            --accent-blue: #bde0fe;
            --text-light: #f8fafc;
            --card-bg: rgba(255, 255, 255, 0.05);
            --glow-pink: rgba(255, 175, 204, 0.3);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background-color: var(--bg-dark);
            color: var(--text-light);
            overflow-x: hidden;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* --- Ambient Background Animations --- */
        @keyframes floatAmbient {
            0% { transform: translate(0, 0) rotate(0deg); opacity: 0; }
            10% { opacity: 0.3; }
            90% { opacity: 0.3; }
            100% { transform: translate(100px, -500px) rotate(360deg); opacity: 0; }
        }

        @keyframes breathe {
            0%, 100% { transform: scale(1); opacity: 0.8; }
            50% { transform: scale(1.02); opacity: 1; }
        }

        @keyframes unlockFlash {
            0% { border-color: var(--soft-pink); transform: scale(1); }
            50% { border-color: white; transform: scale(1.05); box-shadow: 0 0 40px var(--hot-pink); }
            100% { border-color: var(--soft-pink); transform: scale(1); }
        }

        @keyframes lineFadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .floating-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            overflow: hidden;
        }

        .float-item {
            position: absolute;
            animation: floatAmbient 15s linear infinite;
            font-size: 1.5rem;
            user-select: none;
            opacity: 0;
        }

        /* --- Login Screen --- */
        #login-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            width: 100%;
            z-index: 100;
            text-align: center;
            padding: 20px;
        }

        .login-card {
            background: var(--card-bg);
            backdrop-filter: blur(12px);
            padding: 2.5rem;
            border-radius: 24px;
            border: 1px solid var(--soft-pink);
            max-width: 400px;
            width: 100%;
            animation: slideUp 0.8s ease-out;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }

        .login-card h1 {
            color: var(--pastel-blue);
            margin-bottom: 0.5rem;
            font-size: 2rem;
        }

        .login-card input {
            width: 100%;
            padding: 14px;
            margin: 1rem 0;
            border-radius: 12px;
            border: 1px solid var(--accent-blue);
            background: rgba(0,0,0,0.4);
            color: white;
            text-align: center;
            outline: none;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .login-card input:focus {
            border-color: var(--soft-pink);
            box-shadow: 0 0 10px var(--glow-pink);
        }

        .login-card button {
            background: var(--soft-pink);
            border: none;
            padding: 14px 28px;
            border-radius: 12px;
            color: var(--bg-dark);
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            font-size: 1rem;
        }

        .login-card button:active {
            transform: scale(0.95);
        }

        .login-card button:hover {
            background: var(--hot-pink);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px var(--glow-pink);
        }

        /* --- Main Content --- */
        #main-content {
            display: none;
            width: 100%;
            max-width: 1200px;
            padding: 2rem 1.5rem;
            animation: slideUp 0.8s ease-out;
        }

        header h1 {
            color: var(--soft-pink);
            font-size: 2.8rem;
            margin-bottom: 0.5rem;
            text-shadow: 0 0 15px rgba(255, 175, 204, 0.4);
        }

        /* --- Daily Grid & 3D Cards --- */
        .daily-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 2rem;
            width: 100%;
        }

        .day-card {
            perspective: 1200px;
            height: 380px;
            cursor: pointer;
        }

        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            transform-style: preserve-3d;
        }

        .day-card.flipped .card-inner {
            transform: rotateY(180deg);
        }

        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            background: var(--card-bg);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 24px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 25px;
            backdrop-filter: blur(8px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.3);
        }

        .card-back {
            transform: rotateY(180deg);
            border-color: var(--soft-pink);
            justify-content: center;
        }

        .day-card.locked .card-front {
            background: rgba(15, 23, 42, 0.6);
            filter: blur(0.5px);
            animation: breathe 4s ease-in-out infinite;
        }

        .day-card.unlocked .card-front {
            border-color: var(--soft-pink);
        }

        .day-card.unlocked:hover .card-front {
            transform: translateY(-5px);
            box-shadow: 0 15px 45px rgba(255, 175, 204, 0.4);
            border-color: var(--hot-pink);
        }

        .day-card.just-unlocked .card-front {
            animation: unlockFlash 1s ease-out;
        }

        .day-label {
            position: absolute;
            top: 15px;
            left: 20px;
            font-size: 0.85rem;
            color: var(--pastel-blue);
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .lock-icon {
            font-size: 3.5rem;
            margin-bottom: 15px;
            opacity: 0.4;
        }

        .countdown-small {
            font-family: monospace;
            font-size: 1.1rem;
            color: var(--pastel-blue);
            margin-top: 12px;
            background: rgba(162, 210, 255, 0.15);
            padding: 6px 16px;
            border-radius: 10px;
        }

        /* Poetic Presentation */
        .day-content {
            font-size: 1.05rem;
            line-height: 1.6;
            color: var(--text-light);
            display: flex;
            flex-direction: column;
            gap: 4px;
            width: 100%;
        }

        .poetic-line {
            opacity: 0;
            display: block;
        }

        .day-card.flipped .poetic-line {
            animation: lineFadeIn 0.5s ease-out forwards;
        }

        .poetic-break {
            height: 12px;
        }

        .highlight-last {
            color: var(--soft-pink);
            font-style: italic;
            font-weight: 600;
            text-shadow: 0 0 10px var(--glow-pink);
            margin-top: 4px;
        }

        /* Day 7 Love Letter Style */
        .letter-style {
            text-align: left;
            align-self: flex-start;
            padding-left: 10px;
            font-family: 'Comic Sans MS', cursive, sans-serif;
            font-size: 0.9rem;
        }
        
        .letter-style .poetic-line {
            margin-bottom: 1px;
        }
        
        .letter-style .highlight-last {
            text-align: center;
            width: 100%;
            margin-top: 10px;
            font-size: 1.1rem;
        }

        /* Spotify Embed Styles */
        .spotify-container {
            width: 100%;
            margin: 15px 0;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            opacity: 0;
        }

        .day-card.flipped .spotify-container {
            animation: lineFadeIn 0.5s ease-out 0.3s forwards;
        }

        /* --- Day 14 Special --- */
        .valentine-celebration {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(15, 23, 42, 0.98);
            z-index: 200;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 20px;
            backdrop-filter: blur(10px);
        }

        .valentine-card {
            background: var(--bg-dark);
            border: 2px solid var(--soft-pink);
            padding: 4rem 2rem;
            border-radius: 40px;
            box-shadow: 0 0 70px rgba(255, 175, 204, 0.4);
            animation: pulse 2.5s infinite ease-in-out;
            max-width: 500px;
            width: 95%;
        }

        .btn-yes {
            padding: 16px 40px;
            border-radius: 50px;
            border: none;
            background: var(--soft-pink);
            color: var(--bg-dark);
            font-size: 1.3rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 8px 20px rgba(255, 175, 204, 0.3);
        }

        .btn-yes:hover {
            background: var(--hot-pink);
            transform: scale(1.1) translateY(-3px);
            box-shadow: 0 10px 30px rgba(255, 133, 161, 0.6);
        }

        /* Confetti Particles */
        .particle {
            position: fixed;
            pointer-events: none;
            z-index: 400;
        }

        @keyframes particleSlide {
            0% { transform: translate(0,0) scale(1); opacity: 1; }
            100% { transform: translate(var(--x), var(--y)) scale(0); opacity: 0; }
        }

        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
    </style>
<link rel="stylesheet" href="/index.css">
</head>
<body>

    <div class="floating-bg" id="floating-bg"></div>

    <!-- Login Screen -->
    <div id="login-screen">
        <div class="login-card">
            <h1>üêæ Hello Bibi üêæ</h1>
            <p class="intro" style="margin-bottom: 1.5rem; opacity: 0.8;">Welcome to our little cat sanctuary</p>
            <input type="password" id="password-input" placeholder="Type secret code...">
            <button id="login-btn" onclick="checkPassword()">Unlock Paws & Hearts</button>
            <p id="login-error" style="color: #ff6b6b; margin-top: 15px; font-size: 0.9rem; display: none; font-weight: bold;">üôÄ Oh no, bibi! That's not right!</p>
            <p class="hint" style="font-size: 0.8rem; color: var(--pastel-blue); opacity: 0.7; margin-top: 15px;">Hint: our fav position</p>
        </div>
    </div>

    <!-- Main Content -->
    <div id="main-content">
        <header>
            <h1 style="text-align: center;">Nihal ‚ù§Ô∏è Harini</h1>
            <p style="text-align: center; color: var(--pastel-blue); font-style: italic;">A count-down of surprises for my precious bibi</p>
            <div style="text-align: center; width: 100%; margin-top: 2rem;">
                <div style="background: rgba(255, 175, 204, 0.1); padding: 1.2rem 2rem; border-radius: 20px; display: inline-block; border: 2px dashed var(--soft-pink); min-width: 250px;">
                    <div style="font-size: 0.85rem; text-transform: uppercase; letter-spacing: 1.5px; margin-bottom: 8px; opacity: 0.9; color: var(--pastel-blue);">Next Surprise In</div>
                    <div id="global-timer" style="font-family: 'Courier New', Courier, monospace; font-size: 2rem; color: var(--soft-pink); font-weight: bold;">--:--:--</div>
                </div>
            </div>
        </header>

        <div class="daily-grid" id="daily-grid" style="margin-top: 3.5rem;">
            <!-- Cards will be injected by JS -->
        </div>

        <footer style="margin-top: 6rem; margin-bottom: 4rem; color: var(--pastel-blue); opacity: 0.7; font-size: 1rem; text-align: center;">
            Crafted with all the love in the world by Nihal for Harini Bibi üê±üíñ
        </footer>
    </div>

    <!-- Valentine Ask Screen (Day 14) -->
    <div id="valentine-celebration" class="valentine-celebration">
        <div class="valentine-card">
            <div style="font-size: 5rem; margin-bottom: 15px;">üòªüêæ</div>
            <h2 style="font-size: 2.8rem; color: var(--soft-pink); margin-bottom: 1rem;">Harini bibi...</h2>
            <p style="font-size: 1.8rem; color: var(--pastel-blue); margin-bottom: 15px;">will you be my valentine?</p>
            <div class="btn-group" style="display: flex; gap: 20px; justify-content: center; margin-top: 3rem;">
                <button class="btn-yes" onclick="confirmValentine()">yes</button>
                <button class="btn-yes" onclick="confirmValentine()">yesssss</button>
            </div>
        </div>
    </div>

    <!-- Final Celebration Screen -->
    <div id="final-celebration-screen" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: radial-gradient(circle, #1e293b, var(--bg-dark)); z-index: 300; flex-direction: column; justify-content: center; align-items: center; color: var(--soft-pink); text-align: center;">
        <div style="font-size: 7rem; margin-bottom: 25px; animation: pulse 1s infinite alternate;">üòªüíûüåü</div>
        <h1 style="font-size: 2.5rem; max-width: 800px; margin: 20px; line-height: 1.3; animation: slideUp 1.2s ease-out; text-shadow: 0 0 20px rgba(255, 175, 204, 0.5);">Forever yours, my bibi thangoooo!<br>Happy Valentine's Day!</h1>
        <p style="color: var(--pastel-blue); font-size: 1.4rem;">You are my favorite purr-son ever.</p>
        <div style="margin-top: 60px; display: flex; gap: 20px;" id="final-hearts"></div>
    </div>

    <script>
        const PASSWORD = "butterscotch";

        class SoundManager {
            constructor() {
                this.ctx = null;
                this.enabled = true;
            }

            init() {
                if (!this.ctx) {
                    this.ctx = new (window.AudioContext || window.webkitAudioContext)();
                }
            }

            playTone(freq, type, duration, volume = 0.1) {
                if (!this.enabled || !this.ctx) return;
                const osc = this.ctx.createOscillator();
                const gain = this.ctx.createGain();
                osc.type = type;
                osc.frequency.setValueAtTime(freq, this.ctx.currentTime);
                gain.gain.setValueAtTime(volume, this.ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.0001, this.ctx.currentTime + duration);
                osc.connect(gain);
                gain.connect(this.ctx.destination);
                osc.start();
                osc.stop(this.ctx.currentTime + duration);
            }

            click() { this.init(); this.playTone(800, 'sine', 0.1, 0.05); }
            flip() { this.init(); this.playTone(300, 'sine', 0.3, 0.03); }
            unlock() {
                this.init();
                [440, 554, 659, 880].forEach((f, i) => {
                    setTimeout(() => this.playTone(f, 'triangle', 0.5, 0.03), i * 100);
                });
            }
            celebrate() {
                this.init();
                [523, 659, 783, 1046, 1318].forEach((f, i) => {
                    setTimeout(() => this.playTone(f, 'sine', 0.8, 0.05), i * 120);
                });
            }
        }

        const sfx = new SoundManager();

const DAYS_CONTENT = [
  // Day 1
  "thangooooo üíó\n[BREAK]\nlove you mutheww, baby..\n[BREAK]\ni want this to be\nforever‚Ä¶\n[BREAK]\ntill the last breath,\nwe should be together\n[BREAK]\ntill we dissolve in soil‚Ä¶\n[BREAK]\nwith catnips\nand a garden\nsurrounded by cats\n[BREAK]\nin our grave üêæ\n[BREAK]\nlove youuu",

  // Day 2
  "you remember this day‚Ä¶\n[BREAK]\nour first trippppp\ntooo amritsarrr\n[BREAK]\nmy besetettssstst trip\nwith my baby\n[BREAK]\nwe gooo again üíï",

  // Day 3
  "thankk youuu thangooo\n[BREAK]\nthank youu so muuchhh,\nmaking my day better\n[BREAK]\ni love youu so muchh bibiii",

  // Day 4
  "thangooo, remember\n[BREAK]\ni willl be withhh you,\nand handle anything u face\n[BREAK]\ni will try my best\nto take care of youu bibi\n[BREAK]\nlove youu thangoo",

  // Day 5
  "i have a surprise\nfor my babyyyy\n[BREAK]\nme will give u\nwhen we meet",

  // Day 6 ‚Äî Playlist
  "i created this playlist\nfor myyy bibi üíó\n[BREAK]\nevery song reminds me of you\n[PLAYLIST:https://open.spotify.com/playlist/1RyVG34jTbGRRW2tACJdwt]\n[BREAK]\npress play & think of me üéß",

  // Day 7 ‚Äî Letter format
  "to: Harini R\nErode 6767\n[BREAK]\nfrom: skibidi nihal\nmadikeri 6767\n[BREAK]\nsub: my feelings for you\n[BREAK]\nheybababababayyyyyy thangoooooo, my bibi,\n[BREAK]\ni love youuu so muchhh bibi thangooo.\ni love whatever u doing.\n[BREAK]\ni love your hair.\ni love your baby hand.\nbaby leg.\nbaby little little face.\n[BREAK]\nayoooo babyyyyyyyyy love youuu üíó\n[BREAK]\nmuhhhhh muhhhh",

  // Day 8
  "today wee have a taskk üêæ\n[BREAK]\nwe need to take\na pictures together",

  // Day 9
  "im proud of youuu\nmy babyyyy üíó\n[BREAK]\nmy babyyy is zslleepinggggg\nmy bibi is eating goood foood\n[BREAK]\nim proud of youu\nmy thangooo",

  // Day 10
  "todyayyy is\nfoooooddddd dayyyyyy üçΩÔ∏è\n[BREAK]\nletsss eatttt\nbabyyy\n[BREAK]\ncarrrr muhhhh",

  // Day 11
  "thangooooo\n[BREAK]\ntoday we need to be honest\nand speakkk everything\nhave in our headdd\n[BREAK]\nmy bibi",

  // Day 12
  "todayyyy we playy gamesss üéÆ\n[BREAK]\nyayyyyyyyy",

  // Day 13
  "todayyy no surpriseee\n[BREAK]\ntomorrooow is a big dayyyyyyy\nmy babyyyyy thangoooooooooooo\n[BREAK]\nlove youuu",

  // Day 14
  "will you be my valentine? üíñ"
];


        const TARGET_TIMESTAMPS = [
            Date.UTC(2026, 1, 1, 18, 29, 0), Date.UTC(2026, 1, 2, 0, 30, 0),
            Date.UTC(2026, 1, 3, 0, 30, 0), Date.UTC(2026, 1, 4, 0, 30, 0),
            Date.UTC(2026, 1, 5, 0, 30, 0), Date.UTC(2026, 1, 6, 0, 30, 0),
            Date.UTC(2026, 1, 7, 0, 30, 0), Date.UTC(2026, 1, 8, 0, 30, 0),
            Date.UTC(2026, 1, 9, 0, 30, 0), Date.UTC(2026, 1, 10, 0, 30, 0),
            Date.UTC(2026, 1, 11, 0, 30, 0), Date.UTC(2026, 1, 12, 0, 30, 0),
            Date.UTC(2026, 1, 13, 0, 30, 0), Date.UTC(2026, 1, 14, 0, 30, 0),
        ];

        let unlockStates = new Array(14).fill(false);

        function checkPassword() {
            sfx.click();
            const input = document.getElementById('password-input').value.toLowerCase().trim();
            const error = document.getElementById('login-error');
            if (input === PASSWORD) {
                document.getElementById('login-screen').style.display = 'none';
                document.getElementById('main-content').style.display = 'block';
                initApp();
            } else {
                error.style.display = 'block';
                error.style.animation = 'none';
                error.offsetHeight; 
                error.style.animation = 'shake 0.3s ease-in-out';
            }
        }

        function initApp() {
            const container = document.getElementById('floating-bg');
            const items = ['üíñ', 'üêæ', '‚ú®', 'üíì', 'üêæ', 'üéÄ', 'üå∏'];
            for (let i = 0; i < 40; i++) {
                const el = document.createElement('div');
                el.className = 'float-item';
                el.innerText = items[Math.floor(Math.random() * items.length)];
                el.style.left = Math.random() * 100 + 'vw';
                el.style.top = (100 + Math.random() * 100) + 'vh';
                el.style.animationDuration = (10 + Math.random() * 15) + 's';
                el.style.animationDelay = (Math.random() * 10) + 's';
                el.style.fontSize = (0.8 + Math.random() * 1) + 'rem';
                container.appendChild(el);
            }
            updateGrid();
            updateTick();
            setInterval(updateTick, 1000);
        }

        function formatPoeticText(text, isLetter = false) {
            const lines = text.split('\n');
            let resultHTML = isLetter ? '<div class="letter-style">' : '';
            let lineIndex = 0;
            
            lines.forEach((line, idx) => {
                if (line.includes('[BREAK]')) {
                    resultHTML += `<div class="poetic-break"></div>`;
                } else if (line.includes('[PLAYLIST:')) {
                    // Extract URL using regex
                    const match = line.match(/\[PLAYLIST:(.*?)\]/);
                    if (match && match[1]) {
                        let playlistUrl = match[1];
                        // Convert open.spotify.com/playlist/ID to open.spotify.com/embed/playlist/ID
                        const embedUrl = playlistUrl.replace('open.spotify.com/playlist/', 'open.spotify.com/embed/playlist/');
                        resultHTML += `
                            <div class="spotify-container">
                                <iframe style="border-radius:12px" src="${embedUrl}?utm_source=generator&theme=0" width="100%" height="80" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
                            </div>
                        `;
                    }
                } else {
                    const isLast = idx === lines.length - 1;
                    const delay = lineIndex * 0.15;
                    const cssClass = isLast ? 'poetic-line highlight-last' : 'poetic-line';
                    resultHTML += `<span class="${cssClass}" style="animation-delay: ${delay}s">${line.trim()}</span>`;
                    lineIndex++;
                }
            });
            
            if (isLetter) resultHTML += '</div>';
            return resultHTML;
        }

        function updateGrid() {
            const grid = document.getElementById('daily-grid');
            const now = Date.now();

            TARGET_TIMESTAMPS.forEach((targetTime, index) => {
                const isUnlocked = now >= targetTime;
                const previouslyLocked = unlockStates[index] === false;
                unlockStates[index] = isUnlocked;
                
                let card = document.getElementById(`day-card-${index}`);
                if (!card) {
                    card = document.createElement('div');
                    card.id = `day-card-${index}`;
                    card.className = 'day-card';
                    card.onclick = () => toggleFlip(index);
                    grid.appendChild(card);
                }

                card.className = `day-card ${isUnlocked ? 'unlocked' : 'locked'} ${card.classList.contains('flipped') ? 'flipped' : ''}`;
                if (isUnlocked && previouslyLocked && now - targetTime < 5000) {
                    card.classList.add('just-unlocked');
                    sfx.unlock();
                }
                
                let backContent = '';
                if (index === 13) {
                    backContent = '<p style="font-weight:bold; color:var(--soft-pink); margin-bottom:15px; font-size: 1.5rem;">The Final Mystery! üíñ</p><button onclick="sfx.click(); askValentine(); event.stopPropagation();" style="background:var(--soft-pink); border:none; padding:12px 30px; border-radius:15px; font-weight:bold; cursor:pointer; color:var(--bg-dark); transition:0.3s; box-shadow:0 4px 15px rgba(255,175,204,0.4);">Open Special Surprise</button>';
                } else {
                    backContent = formatPoeticText(DAYS_CONTENT[index], index === 6);
                }

                let cardHTML = `
                    <div class="card-inner">
                        <div class="card-front">
                            <div class="day-label">Day ${index + 1}</div>
                            ${isUnlocked ? '<div style="font-size:4rem; filter: drop-shadow(0 0 10px var(--soft-pink));">üéÅ</div>' : '<div class="lock-info"><div class="lock-icon">üîí</div><div class="countdown-small" id="card-timer-'+index+'">--:--:--</div></div>'}
                        </div>
                        <div class="card-back">
                            <div class="day-label" style="opacity:0.5;">Day ${index + 1}</div>
                            <div class="day-content">
                                ${backContent}
                            </div>
                        </div>
                    </div>
                `;
                card.innerHTML = cardHTML;
            });
        }

        function toggleFlip(index) {
            const card = document.getElementById(`day-card-${index}`);
            if (unlockStates[index]) {
                card.classList.toggle('flipped');
                sfx.flip();
            } else {
                sfx.click();
            }
        }

        function updateTick() {
            const now = Date.now();
            let nextUnlockTime = null;
            let allUnlocked = true;
            let needsRerender = false;

            TARGET_TIMESTAMPS.forEach((targetTime, index) => {
                const diff = targetTime - now;
                if (diff > 0) {
                    allUnlocked = false;
                    if (!nextUnlockTime || targetTime < nextUnlockTime) nextUnlockTime = targetTime;
                    const timerEl = document.getElementById(`card-timer-${index}`);
                    if (timerEl) timerEl.innerText = formatTime(diff);
                } else if (unlockStates[index] === false) {
                    needsRerender = true;
                }
            });

            if (needsRerender) updateGrid();
            const globalTimer = document.getElementById('global-timer');
            if (nextUnlockTime) globalTimer.innerText = formatTime(nextUnlockTime - now);
            else if (allUnlocked) globalTimer.innerText = "Everything is Unlocked! üòª";
        }

        function formatTime(ms) {
            const totalSeconds = Math.floor(ms / 1000);
            const days = Math.floor(totalSeconds / (3600 * 24));
            const hours = Math.floor((totalSeconds % (3600 * 24)) / 3600);
            const minutes = Math.floor((totalSeconds % 3600) / 60);
            const seconds = totalSeconds % 60;
            let str = "";
            if (days > 0) str += days + "d ";
            str += `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            return str;
        }

        function spawnConfetti() {
            const icons = ['üê±', 'üíñ', 'üêæ', '‚ú®', 'üíì'];
            for (let i = 0; i < 50; i++) {
                const p = document.createElement('div');
                p.className = 'particle';
                p.innerText = icons[Math.floor(Math.random() * icons.length)];
                p.style.left = '50%'; p.style.top = '50%';
                const angle = Math.random() * Math.PI * 2;
                const dist = 100 + Math.random() * 400;
                p.style.setProperty('--x', Math.cos(angle) * dist + 'px');
                p.style.setProperty('--y', Math.sin(angle) * dist + 'px');
                p.style.animation = `particleSlide ${1 + Math.random()}s ease-out forwards`;
                document.body.appendChild(p);
                setTimeout(() => p.remove(), 2000);
            }
        }

        function askValentine() {
            document.getElementById('valentine-celebration').style.display = 'flex';
            spawnConfetti();
        }

        function confirmValentine() {
            sfx.celebrate();
            spawnConfetti();
            document.getElementById('valentine-celebration').style.display = 'none';
            document.getElementById('final-celebration-screen').style.display = 'flex';
            const heartContainer = document.getElementById('final-hearts');
            const icons = ['üíó', 'üêæ', 'üòª', 'üíñ', '‚≠ê', 'üêæ', 'üíì'];
            for (let i = 0; i < 25; i++) {
                const h = document.createElement('span');
                h.innerText = icons[i % icons.length];
                h.style.fontSize = (2.5 + Math.random() * 2) + 'rem';
                h.style.animation = 'pulse 1.2s infinite alternate';
                h.style.animationDelay = (i * 0.1) + 's';
                heartContainer.appendChild(h);
            }
        }

        document.getElementById('password-input').addEventListener('keypress', (e) => { if (e.key === 'Enter') checkPassword(); });
    </script>
<script type="module" src="/index.tsx"></script>
</body>
</html>
